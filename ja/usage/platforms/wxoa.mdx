---
title: "WeChat Official Account ボットのデプロイ"
---

WeChat Official Account ボットをデプロイして LangBot に接続します。

## LangBot WeChat Official Account 統合モード

現在、LangBot は WeChat Official Accounts と統合する 2 つの方法を提供しています：

1. **従来のメッセージ交換モード**
   - 公式アカウントはリクエストを **15 秒**以内に処理する必要があり、このタイムアウトを超える AI 生成コンテンツは送信できません。
   - AI コンテンツ生成のタイムアウトが発生すると、LangBot はコンソールにリクエストタイムアウト情報を出力します。

2. **「任意のテキストを送信して返信を取得」モード**
   - この方法は **15 秒**の制限を破ることができますが、**非常に長いテキスト**は正常に送信されない場合があります。
   - この方法を使用する場合、公式アカウントにメッセージを送信すると、「AI が考えています。回答を得るには任意のコンテンツを送信してください」と返信されます。この時点で、回答を得るために任意のコンテンツを送信する必要があります。

より複雑な機能については、カスタマイズされたサポートのために **LangBot チーム**にお問い合わせください。

## ボットの作成

[WeChat Official Account Platform](https://mp.weixin.qq.com/)に入り、すでに公式アカウントをお持ちの場合は、QR コードをスキャンしてログインしてコンソールに入ります。
以前に公式アカウントを登録したことがない場合は、今すぐ登録をクリックし、「公式アカウント」を選択し、順番に情報を入力し、コンソールに入ります。コンソールは次のようになります：
![Console Page](/images/zh/deploy/bots/wxoa/wxoa1.png)


## コールバックアドレスの設定

### 設定項目の取得

「設定と開発」、「開発インターフェイス管理」をクリックすると、次のようなページが表示されます：
![Set Development Items](/images/zh/deploy/bots/wxoa/wxoa2.png)

「開発者 ID（AppID）」、「開発者パスワード（AppSecret）」を記録し、LangBot がデプロイされているサーバーを「IP ホワイトリスト」に追加します。

### LangBot のリバースプロキシの設定

WeChat Official Accounts は http（ポート 80）と https（ポート 443）のみをサポートしているため、ドキュメント [HTTP リバースプロキシと SSL の設定](/en/workshop/production/proxy-and-ssl)に従って設定してください。

### コールバックアドレスの保存

サーバー設定を設定をクリックし、「Token」、「EncodingAESKey」を入力し、メッセージの暗号化/復号化方式を「Safe Mode」に変更します。

この時点で、LangBot Webui ページを開き、新しいボットを作成し、取得した 4 つの設定項目（AppID、AppSecret、token、EncodingAESKey）を入力します

![Set Development Items](/images/zh/deploy/bots/wxoa/connect_to_langbot.png)

設定項目の「Mode」オプションは、選択された統合モードです。デフォルトは「drop」です。「drop」は従来のメッセージ交換モードで、「passive」は「任意のテキストを送信して返信を取得」モードです。

「LoadingMessage」オプションはローディングメッセージで、他のコンテンツに変更でき、モードが「passive」の場合にのみ有効です。「enable」を「true」に設定します。

正常に入力した後、LangBot ホームページで対応するボットを有効にして選択し、設定ページをクリックして入り、Webhook コールバックアドレスをコピーし、WeChat Official Account ボット設定ページに戻って「URL」に入力します。たとえば、URL を「https://your_domain_name/bots/xxxxx」として入力します。ここで「your_domain_name」は Caddy に入力したドメイン名です。保存をクリックします。正常に保存できれば、デプロイは成功です。**システムエラー、後でもう一度お試しください**が表示された場合は、上記の設定内容が正しく入力されているかどうかを再確認してください。
